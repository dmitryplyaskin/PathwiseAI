# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ: –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã–π –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è —É—Ä–æ–∫–æ–≤

## üéØ –û–±–∑–æ—Ä —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞ —Å –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫–æ–º –≤ —Ä–∞–º–∫–∞—Ö —É—Ä–æ–∫–æ–≤. –°—Ç—É–¥–µ–Ω—Ç—ã –º–æ–≥—É—Ç –∑–∞–¥–∞–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã, —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –≤–µ—Ç–∫–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤ –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –∏—Å—Ç–æ—Ä–∏–µ–π –æ–±—â–µ–Ω–∏—è.

## ‚ú® –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –ø–æ–º–æ—â—å**

- –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —É—Ä–æ–∫–∞
- –û—Ç–≤–µ—Ç—ã –æ—Å–Ω–æ–≤—ã–≤–∞—é—Ç—Å—è –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–µ —É—Ä–æ–∫–∞
- –ü–æ–º–æ–≥–∞–µ—Ç —É–≥–ª—É–±–∏—Ç—å –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ç–µ–º—ã

### 2. **–í–µ—Ç–∫–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤ (Threads)**

- –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤–µ—Ç–æ–∫
- –ö–∞–∂–¥–∞—è –≤–µ—Ç–∫–∞ - –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –≤–µ—Ç–∫–∞–º–∏ –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –û—Å–Ω–æ–≤–Ω–∞—è –≤–µ—Ç–∫–∞ (`main`) –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞

### 3. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ç–∫–∞–º–∏**

- **–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ç–∫—É** - –Ω–∞—á–∞—Ç—å –Ω–æ–≤–æ–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –ø–æ –¥—Ä—É–≥–æ–π —Ç–µ–º–µ
- **–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –≤–µ—Ç–∫–∞–º–∏** - –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –æ–±—Å—É–∂–¥–µ–Ω–∏—è–º
- **–£–¥–∞–ª–µ–Ω–∏–µ –≤–µ—Ç–æ–∫** - –æ—á–∏—Å—Ç–∏—Ç—å –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ä–∞–∑–≥–æ–≤–æ—Ä—ã
- **–ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤** - –ø–æ–ª—É—á–∏—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –æ—Ç–≤–µ—Ç –æ—Ç –ò–ò

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### Backend (NestJS)

#### –°—É—â–Ω–æ—Å—Ç–∏

- **ChatMessage** - —Å–æ–æ–±—â–µ–Ω–∏—è —Å –ø–æ–ª–µ–º `threadId`
- **Chat** - —á–∞—Ç –ø—Ä–∏–≤—è–∑–∞–Ω –∫ —É—Ä–æ–∫—É

#### API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

```
POST   /courses/lessons/:id/ask                     - –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å
GET    /courses/lessons/:id/threads                 - –°–ø–∏—Å–æ–∫ –≤–µ—Ç–æ–∫
GET    /courses/lessons/:id/threads/:threadId       - –°–æ–æ–±—â–µ–Ω–∏—è –≤–µ—Ç–∫–∏
DELETE /courses/lessons/:id/threads/:threadId       - –£–¥–∞–ª–∏—Ç—å –≤–µ—Ç–∫—É
POST   /courses/lessons/:id/regenerate/:messageId   - –ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç
```

#### –°–µ—Ä–≤–∏—Å—ã

- **ChatService** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –∏ –≤–µ—Ç–∫–∞–º–∏
- **OpenRouterService** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å LLM
- **CoursesService** - —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ —É—Ä–æ–∫–æ–≤ –∏ —á–∞—Ç–∞

### Frontend (React + Material-UI)

#### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- **LessonPage** - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —É—Ä–æ–∫–∞
- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ—Ç–∫–∞–º–∏
- –ú–µ–Ω—é –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–µ—Ç–æ–∫
- –î–∏–∞–ª–æ–≥ —É–¥–∞–ª–µ–Ω–∏—è
- –ú–µ–Ω—é –¥–µ–π—Å—Ç–≤–∏–π —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

#### –°–æ—Å—Ç–æ—è–Ω–∏–µ

```typescript
threads: Thread[]           // –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≤–µ—Ç–æ–∫
currentThreadId: string     // –¢–µ–∫—É—â–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è –≤–µ—Ç–∫–∞
messages: Message[]         // –°–æ–æ–±—â–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π –≤–µ—Ç–∫–∏
```

## üìù –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –î–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞

1. **–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å**
   - –ù–∞–∂–∞—Ç—å "–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫—É"
   - –í–≤–µ—Å—Ç–∏ –≤–æ–ø—Ä–æ—Å
   - –ü–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —É—Ä–æ–∫–∞

2. **–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ç–∫—É**
   - –ù–∞–∂–∞—Ç—å "–ù–æ–≤–∞—è –≤–µ—Ç–∫–∞"
   - –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å –ø–æ –Ω–æ–≤–æ–π —Ç–µ–º–µ
   - –°—Ç–∞—Ä—ã–µ –≤–µ—Ç–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

3. **–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –º–µ–∂–¥—É –≤–µ—Ç–∫–∞–º–∏**
   - –ù–∞–∂–∞—Ç—å –Ω–∞ –∏–∫–æ–Ω–∫—É —Å —á–∏—Å–ª–æ–º –≤–µ—Ç–æ–∫
   - –í—ã–±—Ä–∞—Ç—å –Ω—É–∂–Ω—É—é –≤–µ—Ç–∫—É –∏–∑ —Å–ø–∏—Å–∫–∞

4. **–ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç**
   - –ù–∞–∂–∞—Ç—å "‚ãÆ" –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–∏ –ò–ò
   - –í—ã–±—Ä–∞—Ç—å "–ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å"
   - –ü–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞

5. **–£–¥–∞–ª–∏—Ç—å –≤–µ—Ç–∫—É**
   - –í –º–µ–Ω—é –≤–µ—Ç–æ–∫ –Ω–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É —É–¥–∞–ª–µ–Ω–∏—è
   - –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

#### –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—è thread_id
psql -U username -d database_name -f migration-add-thread-id.sql
```

#### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞

```typescript
const response = await lessonsApi.askQuestion(
  lessonId,
  question,
  threadId, // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 'main'
  lessonContent, // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–∫—Å—Ç —É—Ä–æ–∫–∞
  userId, // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
);
```

## üé® UI/UX –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã

- üü¢ **–û—Å–Ω–æ–≤–Ω–∞—è –≤–µ—Ç–∫–∞** - –≤—ã–¥–µ–ª–µ–Ω–∞ –æ—Å–æ–±–æ, –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞
- üîÄ **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–µ—Ç–∫–∏** - –ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞–Ω—ã, —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úì **–¢–µ–∫—É—â–∞—è –≤–µ—Ç–∫–∞** - –æ—Ç–º–µ—á–µ–Ω–∞ –≥–∞–ª–æ—á–∫–æ–π –≤ –º–µ–Ω—é
- üîÑ **–ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è** - –∫–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞ –∫–∞–∂–¥–æ–º –æ—Ç–≤–µ—Ç–µ –ò–ò

### –ê–Ω–∏–º–∞—Ü–∏–∏

- –ü–ª–∞–≤–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π (Fade)
- Hover —ç—Ñ—Ñ–µ–∫—Ç—ã –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö
- –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –≤–µ—Ç–∫–∏

### –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞

- –í–æ–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: —Å–≤–µ—Ç–ª–æ-—Å–∏–Ω–∏–π —Ñ–æ–Ω
- –û—Ç–≤–µ—Ç—ã –ò–ò: –±–µ–ª—ã–π —Ñ–æ–Ω
- –ê–∫—Ü–µ–Ω—Ç—ã: primary blue (#3b82f6)

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ö–æ–Ω—Ç–µ–∫—Å—Ç —É—Ä–æ–∫–∞ –≤ –ø—Ä–æ–º–ø—Ç–∞—Ö

```javascript
const systemPrompt = `
–¢—ã - AI-–ø–æ–º–æ—â–Ω–∏–∫ –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ PathwiseAI.
–°—Ç—É–¥–µ–Ω—Ç –∏–∑—É—á–∞–µ—Ç —É—Ä–æ–∫ –∏ –∑–∞–¥–∞–µ—Ç –≤–æ–ø—Ä–æ—Å—ã.

–ö–û–ù–¢–ï–ö–°–¢ –£–†–û–ö–ê:
${lessonContent}

–¢–≤–æ—è –∑–∞–¥–∞—á–∞:
- –û—Ç–≤–µ—á–∞–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —É—Ä–æ–∫–∞
- –û–±—ä—è—Å–Ω—è–π –ø–æ–Ω—è—Ç–Ω–æ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏
- –ü–æ–º–æ–≥–∞–π —É–≥–ª—É–±–∏—Ç—å –ø–æ–Ω–∏–º–∞–Ω–∏–µ
`;
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Message

```typescript
interface Message {
  id: string;
  type: 'user' | 'bot' | 'preloader';
  content: string;
  threadId: string;
}
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Thread

```typescript
interface Thread {
  threadId: string;
  messageCount: number;
  firstMessage: string;
  createdAt: string;
  lastActivity: string;
}
```

## üìä –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –û—Å–Ω–æ–≤–Ω–∞—è –≤–µ—Ç–∫–∞

```
–£—Ä–æ–∫: "–í–≤–µ–¥–µ–Ω–∏–µ –≤ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ"
‚îú‚îÄ main
   ‚îú‚îÄ Q: "–ß—Ç–æ —Ç–∞–∫–æ–µ supervised learning?"
   ‚îú‚îÄ A: "Supervised learning - —ç—Ç–æ..."
   ‚îú‚îÄ Q: "–ü—Ä–∏–≤–µ–¥–∏ –ø—Ä–∏–º–µ—Ä"
   ‚îî‚îÄ A: "–ù–∞–ø—Ä–∏–º–µ—Ä, –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è..."
```

### –ü—Ä–∏–º–µ—Ä 2: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–µ—Ç–∫–∏

```
–£—Ä–æ–∫: "–í–≤–µ–¥–µ–Ω–∏–µ –≤ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ"
‚îú‚îÄ main
‚îÇ  ‚îú‚îÄ Q: "–ß—Ç–æ —Ç–∞–∫–æ–µ supervised learning?"
‚îÇ  ‚îî‚îÄ A: "Supervised learning - —ç—Ç–æ..."
‚îú‚îÄ thread-1234
‚îÇ  ‚îú‚îÄ Q: "–†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏"
‚îÇ  ‚îî‚îÄ A: "–ù–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ - —ç—Ç–æ..."
‚îî‚îÄ thread-5678
   ‚îú‚îÄ Q: "–ö–∞–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?"
   ‚îî‚îÄ A: "–†–µ–∫–æ–º–µ–Ω–¥—É—é TensorFlow..."
```

## üöÄ –î–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ –≤–µ—Ç–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤
- [ ] –ü–æ–∏—Å–∫ –ø–æ —Å–æ–æ–±—â–µ–Ω–∏—è–º
- [ ] –ó–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –≤–∞–∂–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
- [ ] –°—Ç—Ä–∏–º–∏–Ω–≥ –æ—Ç–≤–µ—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- [ ] –ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–≤
- [ ] –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –≤–µ—Ç–∫–æ–π —Å –¥—Ä—É–≥–∏–º–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞–º–∏

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ö–∞–∂–¥–∞—è –≤–µ—Ç–∫–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–∞ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–≤–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
- –£–¥–∞–ª–µ–Ω–∏–µ –≤–µ—Ç–∫–∏ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ
- –û—Å–Ω–æ–≤–Ω–∞—è –≤–µ—Ç–∫–∞ (`main`) –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —É–¥–∞–ª–µ–Ω–∞
- –ö–æ–Ω—Ç–µ–∫—Å—Ç —É—Ä–æ–∫–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –æ—Ç–≤–µ—Ç–æ–≤
