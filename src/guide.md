Помоги мне продумать полноценную структуру данных для мое проекта.

Описание проекта: Я хочу сделать приложение на основе ллм для изучения чего либо. Допустим пользователь говорит что хочет изучать "Что-то", llm генерирует обучающий материал по теме и затем список вопросов на которые должен ответить юзер. Зайдя на следующий день в приложение, юзер увидит что ему нужно повторить какой либо материал для лучшего закрепления знаний (там какая то умная система с периодичностью запоминания и повторения информации). Если юзер захочет то он может провести себе экзамен, выбрать темы для экзамена и пройти его для закрепления.

Что должно быть:

1. Юзер и вся информация о нем, изначально это заглушка и авторизации и прочего не будет, но хочу сразу заложить основы для того, что бы в будущем можно было расширить сервис.
2. Модуль - конкретная единица материала которая будет изучаться. Там будет отображаться сообщение от llm по заданной теме, можно будет спросить уточняющие вопросы (по сути урезанная версия чата с ллм по конкретной теме). Разная информация о том, когда был изучен модуль, статус его изучения. Вопросы для тестирования и еще что то.
3. Группа модулей? - пока не знаю, но может быть несколько модулей обледенённая во что то единое. Например какой то модуль получается слишком большой и логично разбить его на части
4. Курс - это уже общая группа знаний по конкретной теме, например Язык программирования, Фреймворк, или что то другое, по чем уже можно будет проводить полноценный экзамен и отслеживать прогресс знаний по конкретной крупной теме.

возможно что то еще, пока не знаю. Если требуется поправь мою терминологию и используй более подходящую

Отличная идея для проекта! Создание гибкой и масштабируемой структуры данных с самого начала — это ключ к успеху. Я помогу тебе продумать эту структуру, уточню терминологию и предложу полный набор моделей данных.

### Уточнение терминологии

Твоя терминология уже довольно хороша, но давай сделаем ее более стандартной для образовательных платформ, чтобы было проще ориентироваться:

- **Курс (Course)**: Отлично. Это самая крупная сущность, объединяющая все материалы по одной большой теме (например, "Основы Python").
- **Группа модулей**: Давай назовем это **Раздел (Unit)** или **Глава (Chapter)**. "Раздел" звучит более универсально. Таким образом, курс "Основы Python" может состоять из разделов: "Введение и синтаксис", "Типы данных", "Функции" и т.д.
- **Модуль**: Давай назовем это **Урок (Lesson)**. Это самый маленький, атомарный кусочек учебного материала, который пользователь проходит за один раз. Урок содержит теорию, вопросы для самопроверки и связанный с ним чат.

Итоговая иерархия получается очень логичной и знакомой: **Курс → Раздел → Урок**.

---

### Полноценная структура данных (модели)

Ниже я опишу модели данных, которые можно будет легко перевести в таблицы в реляционной базе данных (например, PostgreSQL, который отлично подойдет).

#### 1. Модель `User` (Пользователь)

Хранит всю информацию о пользователе.

| Поле            | Тип                 | Описание                                                        |
| :-------------- | :------------------ | :-------------------------------------------------------------- |
| `id`            | UUID / Integer (PK) | Уникальный идентификатор пользователя.                          |
| `username`      | String              | Имя пользователя (пока может быть заглушкой, например "Guest"). |
| `email`         | String              | Email (для будущей авторизации).                                |
| `password_hash` | String              | Хеш пароля (для будущей авторизации).                           |
| `settings`      | JSONB               | Настройки пользователя (язык, тема, цели обучения и т.д.).      |
| `created_at`    | Timestamp           | Дата и время регистрации.                                       |
| `updated_at`    | Timestamp           | Дата и время последнего обновления профиля.                     |

---

#### 2. Модель `Course` (Курс)

Объединяет весь материал по одной большой теме.

| Поле          | Тип                 | Описание                                                          |
| :------------ | :------------------ | :---------------------------------------------------------------- |
| `id`          | UUID / Integer (PK) | Уникальный идентификатор курса.                                   |
| `user_id`     | ForeignKey (User)   | Связь с пользователем, который изучает этот курс.                 |
| `title`       | String              | Название курса (например, "JavaScript для начинающих").           |
| `description` | Text                | Краткое описание курса, сгенерированное LLM.                      |
| `status`      | Enum                | Статус изучения курса: `not_started`, `in_progress`, `completed`. |
| `progress`    | Float               | Прогресс прохождения в процентах (0-100).                         |
| `created_at`  | Timestamp           | Дата и время создания курса.                                      |
| `updated_at`  | Timestamp           | Дата и время последнего изменения.                                |

---

#### 3. Модель `Unit` (Раздел)

Логическая группа уроков внутри курса.

| Поле         | Тип                 | Описание                                              |
| :----------- | :------------------ | :---------------------------------------------------- |
| `id`         | UUID / Integer (PK) | Уникальный идентификатор раздела.                     |
| `course_id`  | ForeignKey (Course) | Связь с родительским курсом.                          |
| `title`      | String              | Название раздела (например, "Работа с массивами").    |
| `order`      | Integer             | Порядковый номер раздела внутри курса для сортировки. |
| `created_at` | Timestamp           | Дата и время создания.                                |

---

#### 4. Модель `Lesson` (Урок)

Основная единица контента. Здесь будет храниться логика для интервального повторения.

| Поле                   | Тип                 | Описание                                                          |
| :--------------------- | :------------------ | :---------------------------------------------------------------- |
| `id`                   | UUID / Integer (PK) | Уникальный идентификатор урока.                                   |
| `unit_id`              | ForeignKey (Unit)   | Связь с родительским разделом.                                    |
| `title`                | String              | Название урока (например, "Метод .map()").                        |
| `content`              | Text / Markdown     | Основной учебный материал, сгенерированный LLM.                   |
| `order`                | Integer             | Порядковый номер урока внутри раздела.                            |
| **`status`**           | Enum                | Статус изучения: `not_started`, `learning`, `mastered`.           |
| **`last_reviewed_at`** | Timestamp           | Когда пользователь последний раз повторял этот урок.              |
| **`next_review_at`**   | Timestamp           | **Ключевое поле!** Дата следующего запланированного повторения.   |
| **`ease_factor`**      | Float               | Коэффициент "легкости" (используется в алгоритмах SRS, как SM-2). |
| **`interval`**         | Integer             | Текущий интервал повторения в днях.                               |
| `created_at`           | Timestamp           | Дата и время создания урока.                                      |

**Пояснение по полям для интервального повторения:**
Это сердце твоей "умной системы". Когда пользователь успешно проходит тест по уроку, ты:

1.  Обновляешь `last_reviewed_at`.
2.  Увеличиваешь `interval` и `ease_factor`.
3.  Рассчитываешь `next_review_at` (`now() + interval`).
    Если пользователь отвечает плохо, `interval` сбрасывается или уменьшается.

---

#### 5. Модель `Question` (Вопрос)

Вопрос для проверки знаний по конкретному уроку.

| Поле             | Тип                 | Описание                                                                  |
| :--------------- | :------------------ | :------------------------------------------------------------------------ |
| `id`             | UUID / Integer (PK) | Уникальный идентификатор вопроса.                                         |
| `lesson_id`      | ForeignKey (Lesson) | Связь с уроком, к которому относится вопрос.                              |
| `question_text`  | Text                | Текст вопроса.                                                            |
| `question_type`  | Enum                | Тип вопроса: `multiple_choice`, `open_ended`, `true_false`.               |
| `options`        | JSONB               | Варианты ответов для `multiple_choice` (например, `["A", "B", "C"]`).     |
| `correct_answer` | Text                | Правильный ответ. Для `multiple_choice` это может быть один из `options`. |
| `explanation`    | Text                | Объяснение правильного ответа, сгенерированное LLM.                       |

---

#### 6. Модель `UserAnswer` (Ответ пользователя)

Запись о том, как пользователь ответил на вопрос. Это важно для отслеживания прогресса и корректировки системы повторений.

| Поле          | Тип                   | Описание                                |
| :------------ | :-------------------- | :-------------------------------------- |
| `id`          | UUID / Integer (PK)   | Уникальный идентификатор ответа.        |
| `user_id`     | ForeignKey (User)     | Пользователь, который ответил.          |
| `question_id` | ForeignKey (Question) | Вопрос, на который дан ответ.           |
| `answer_text` | Text                  | Текст ответа, который дал пользователь. |
| `is_correct`  | Boolean               | Был ли ответ правильным.                |
| `answered_at` | Timestamp             | Когда был дан ответ.                    |

---

#### 7. Модель `ClarificationMessage` (Уточняющее сообщение)

Для реализации чата внутри урока.

| Поле           | Тип                 | Описание                              |
| :------------- | :------------------ | :------------------------------------ |
| `id`           | UUID / Integer (PK) | Уникальный идентификатор сообщения.   |
| `lesson_id`    | ForeignKey (Lesson) | Урок, в рамках которого идет общение. |
| `user_id`      | ForeignKey (User)   | Пользователь, отправивший сообщение.  |
| `sender`       | Enum                | Отправитель: `user` или `llm`.        |
| `message_text` | Text                | Текст сообщения.                      |
| `created_at`   | Timestamp           | Дата и время отправки.                |

---

#### 8. Модель `Exam` (Экзамен)

Сущность для проведения экзамена по выбранным темам.

| Поле           | Тип                 | Описание                                                        |
| :------------- | :------------------ | :-------------------------------------------------------------- |
| `id`           | UUID / Integer (PK) | Уникальный идентификатор экзамена.                              |
| `user_id`      | ForeignKey (User)   | Пользователь, который проходит экзамен.                         |
| `course_id`    | ForeignKey (Course) | Курс, по которому проводится экзамен.                           |
| `title`        | String              | Название экзамена (например, "Итоговый экзамен по JavaScript"). |
| `status`       | Enum                | Статус экзамена: `in_progress`, `completed`, `cancelled`.       |
| `score`        | Float               | Итоговый балл (в процентах).                                    |
| `started_at`   | Timestamp           | Время начала экзамена.                                          |
| `completed_at` | Timestamp           | Время завершения экзамена.                                      |

Для связи экзамена с вопросами нужна промежуточная таблица.

#### 9. Модель `ExamResult` (Результаты экзамена)

Связывает экзамен, вопросы и ответы пользователя.

| Поле          | Тип                   | Описание                                      |
| :------------ | :-------------------- | :-------------------------------------------- |
| `id`          | UUID / Integer (PK)   | Уникальный идентификатор записи.              |
| `exam_id`     | ForeignKey (Exam)     | Экзамен, к которому относится этот результат. |
| `question_id` | ForeignKey (Question) | Вопрос из экзамена.                           |
| `user_answer` | Text                  | Ответ пользователя на этот вопрос.            |
| `is_correct`  | Boolean               | Правильность ответа.                          |

---

### Схема взаимосвязей

```
User (1) ---< (M) Course
  |
  `---< (M) UserAnswer
  |
  `---< (M) ClarificationMessage
  |
  `---< (M) Exam

Course (1) ---< (M) Unit
  |
  `---< (M) Exam

Unit (1) ---< (M) Lesson

Lesson (1) ---< (M) Question
  |
  `---< (M) ClarificationMessage

Question (1) ---< (M) UserAnswer
   |
   `---< (M) ExamResult

Exam (1) ---< (M) ExamResult
```

_(где `(1)` — одна, `(M)` — много)_

### Как это будет работать на практике:

1.  **Начало обучения**: Пользователь вводит "Изучить основы Git".
    - Твоя система отправляет запрос к LLM для генерации структуры курса.
    - Создается запись в `Course` (title: "Основы Git").
    - LLM возвращает разделы. Создаются записи в `Unit` (например, "Введение", "Основные команды", "Ветвление").
    - Для каждого раздела LLM генерирует уроки. Создаются записи в `Lesson`.
    - Для каждого урока LLM генерирует теорию (`content`) и 3-5 вопросов (`Question`).

2.  **Процесс обучения**: Пользователь открывает `Lesson`.
    - Читает `content`.
    - Задает вопросы в чате (создаются записи в `ClarificationMessage`).
    - Отвечает на вопросы к уроку. Для каждого ответа создается запись в `UserAnswer`.
    - На основе `is_correct` в `UserAnswer` ты обновляешь поля `next_review_at`, `interval` и `status` у этого `Lesson`.

3.  **Повторение**: Каждый день твое приложение делает запрос: "Показать все `Lesson`, где `next_review_at` <= `сегодняшняя дата` и `user_id` = `текущий пользователь`". Это и есть список уроков для повторения.

4.  **Экзамен**: Пользователь выбирает `Course` для экзамена.
    - Создается запись в `Exam`.
    - Ты выбираешь N вопросов из всех `Lesson` этого курса.
    - Для каждого вопроса и ответа пользователя создается запись в `ExamResult`.
    - После завершения подсчитывается `score` и обновляется запись в `Exam`.

Эта структура данных является надежной основой. Она разделяет данные по логическим блокам, позволяет легко добавлять новый функционал и готова к масштабированию, когда ты решишь добавить полноценную аутентификацию и многопользовательский режим.
