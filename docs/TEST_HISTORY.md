# История тестов

## Описание

Система отображения истории прохождения тестов пользователями. Позволяет просматривать все пройденные тесты, их результаты и детальную информацию по каждому ответу.

## Бэкенд

### Эндпоинты

- `GET /exams/user/:userId` - получение всех экзаменов пользователя
- `GET /exams/lesson/:lessonId/user/:userId` - получение экзаменов для конкретного урока

### Сервисы

- `ExamsService.findExamsByUser(userId: string)` - получение экзаменов пользователя с результатами
- `ExamsService.findExamsByLesson(lessonId: string, userId: string)` - получение экзаменов для конкретного урока

### Сущности

- `Exam` - основная сущность экзамена
- `ExamResult` - результаты по каждому вопросу

## Фронтенд

### Страницы

- `TestHistoryPage` (`/test-history`) - страница истории тестов

### API

- `testsApi.getUserExams(request: GetUserExamsRequest)` - получение истории тестов
- `testsApi.getLessonExams(request: GetLessonExamsRequest)` - получение экзаменов для урока

### Типы

- `ExamHistoryItem` - элемент истории теста
- `GetUserExamsRequest` - запрос получения тестов пользователя
- `GetLessonExamsRequest` - запрос получения экзаменов для урока

## Функциональность

### Отображение статистики

- Общее количество тестов
- Количество завершенных тестов
- Средний балл по завершенным тестам
- Количество тестов в процессе

### Детальная информация

- Название теста и курса
- Статус прохождения
- Балл (для завершенных тестов)
- Даты начала и завершения
- Детали по каждому ответу

### Навигация

- Ссылка "История тестов" в верхней панели навигации
- Доступна только для авторизованных пользователей

### Отображение в уроках

- Результаты тестов отображаются в блоке "Статус прохождения" на странице урока
- Показывается последний завершенный тест с баллом и датой
- Кнопка теста меняет текст в зависимости от наличия пройденных тестов

### Поведение после завершения теста

- После прохождения теста результаты отправляются на сервер, а данные урока/статуса могут быть обновлены повторным запросом.
- Важно: обновление урока выполняется **без размонтирования страницы урока**, чтобы **не закрывать окно результата теста** до явного закрытия пользователем.
- Реализация: `frontend/src/widgets/lesson/ui/LessonPage.tsx` не показывает полноэкранный `LoadingScreen`, если урок уже загружен (фоновая перезагрузка).
- Пропущенные вопросы: при отправке результатов пропуск допускается (ответ может быть пустым/отсутствовать) и считается **неправильным ответом**, а не ошибкой валидации.

## Файлы

- `src/modules/exams/services/exams.service.ts` - сервис экзаменов
- `src/modules/exams/controllers/exams.controller.ts` - контроллер экзаменов
- `frontend/src/pages/test-history/ui/TestHistoryPage.tsx` - страница истории
- `frontend/src/shared/api/tests/api.ts` - API методы
- `frontend/src/shared/api/tests/types.ts` - типы данных
- `frontend/src/app/config/router.tsx` - роутинг
- `frontend/src/app/ui/Layout.tsx` - навигация
